jQuery(document).ready(function(t){var e,a='<img src="../images/loading.gif" style="width:22px;height:22px;">',r='<span class="glyphicon glyphicon-remove-sign" aria-hidden="true" style="color: #ffa5a5"></span>',d=null,i=-1,n=null,s=-1,l="date_thisweek",o="",_="",c="",m="";function h(e,a){"sales"==e?(t(".dashboard_sales_alert").html(a),t(".dashboard_sales_alert").fadeIn(1e3,function(){t(".dashboard_sales_alert").fadeOut(3e3)})):"setting"==e&&(t(".setting_edit_alert").html(a),t(".setting_edit_alert").fadeIn(1e3,function(){t(".setting_edit_alert").fadeOut(3e3)}))}function p(e,r,d){"sales"==e?d?t(".dashboard_sales_waiting").html(a):t(".dashboard_sales_waiting").html(""):"crm"==e?d?(t("#crm1_"+r+"_0").html(a),t("#crm2_"+r+"_0").html(""),t("#crm3_"+r+"_0").html(""),t("#crm4_"+r+"_0").html(""),t("#crm5_"+r+"_0").html(""),t("#crm6_"+r+"_0").html(""),t("#crm7_"+r+"_0").html(""),t("#crm8_"+r+"_0").html(""),t("#crm9_"+r+"_0").html(""),t("#crm10_"+r+"_0").html(""),t(".subrow_"+r).each(function(e){t(this).remove()})):t("#crm1_"+r+"_0").html(""):"kkcrm"==e&&(d?(t("#kkcrm1_"+r+"_0").html(a),t("#kkcrm2_"+r+"_0").html(""),t("#kkcrm3_"+r+"_0").html(""),t("#kkcrm4_"+r+"_0").html(""),t("#kkcrm5_"+r+"_0").html(""),t("#kkcrm6_"+r+"_0").html(""),t("#kkcrm7_"+r+"_0").html(""),t("#kkcrm8_"+r+"_0").html(""),t("#kkcrm9_"+r+"_0").html(""),t("#kkcrm10_"+r+"_0").html("")):t("#kkcrm1_"+r+"_0").html(""))}function u(){if(""!=c)for(var e=c.split(","),a=1;a<=8;a++){t(".table_overall th:nth-child("+a+")").hide(),t(".table_overall td:nth-child("+a+")").hide(),t(".table_dashboard th:nth-child("+(a+3)+")").hide(),t(".table_dashboard td:nth-child("+(a+3)+")").hide();for(var r=0;r<e.length;r++)if(a==e[r]){t(".table_overall th:nth-child("+a+")").show(),t(".table_overall td:nth-child("+a+")").show(),t(".table_dashboard th:nth-child("+(a+3)+")").show(),t(".table_dashboard td:nth-child("+(a+3)+")").show();break}}}function b(){p("sales","",!0),t.ajax({type:"GET",url:"../daemon/ajax_admin/crm_list.php",data:{},success:function(e){p("sales","",!1),"error"!=e?"no_cookie"!=e?(d=jQuery.parseJSON(e),p("sales","",!0),t.ajax({type:"GET",url:"../daemon/ajax_admin/konnektive/crm_active_list.php",data:{},success:function(e){if(p("sales","",!1),"error"==e);else{if("no_cookie"==e)return void(window.location.href="../../admin/login.php");n=jQuery.parseJSON(e)}var a="";if(""==m){for(var r=0;r<d.length;r++)a+='<tr id="row_'+d[r][0]+'" class="crm_row" style="border-top: 1px solid #00b9ab !important"><td>'+(r+1)+"</td>",a+='<td><span id="ll'+d[r][0]+'" class="payment_badge payment_badge_blue crm_name_row">'+d[r][1]+"</span></td>",a+='<td id="crm0_'+d[r][0]+'_0">-</td>',a+='<td id="crm1_'+d[r][0]+'_0"></td>',a+='<td id="crm2_'+d[r][0]+'_0"></td>',a+='<td id="crm3_'+d[r][0]+'_0"></td>',a+='<td id="crm4_'+d[r][0]+'_0"></td>',a+='<td id="crm5_'+d[r][0]+'_0"></td>',a+='<td id="crm6_'+d[r][0]+'_0"></td>',a+='<td id="crm7_'+d[r][0]+'_0"></td>',a+='<td id="crm8_'+d[r][0]+'_0"></td>',a+='<td id="crm9_'+d[r][0]+'_0"></td>',a+='<td id="crm10_'+d[r][0]+'_0"></td>',a+='<td><button type="button" id="setting_'+d[r][0]+'" class="btn btn-link btn-sm btn_setting" data-toggle="modal" data-target="#setting_edit_modal"><span class="glyphicon glyphicon-list" aria-hidden="true"></span></button></td>',a+='<td><button type="button" id="refresh_'+d[r][0]+'" class="btn btn-link btn-sm btn_refresh"><span class="glyphicon glyphicon-refresh" aria-hidden="true"></span></button></td>',a+="</tr>";if(null!=n)for(var r=0;r<n.length;r++)a+='<tr id="kkrow_'+n[r][0]+'" class="kkcrm_row" style="border-top: 1px solid #00b9ab !important"><td>'+(d.length+r+1)+"</td>",a+='<td><span id="kk'+n[r][0]+'" class="payment_badge payment_badge_red crm_name_row">'+n[r][1]+"</span></td>",a+='<td id="kkcrm0_'+n[r][0]+'_0">-</td>',a+='<td id="kkcrm1_'+n[r][0]+'_0"></td>',a+='<td id="kkcrm2_'+n[r][0]+'_0"></td>',a+='<td id="kkcrm3_'+n[r][0]+'_0"></td>',a+='<td id="kkcrm4_'+n[r][0]+'_0"></td>',a+='<td id="kkcrm5_'+n[r][0]+'_0"></td>',a+='<td id="kkcrm6_'+n[r][0]+'_0"></td>',a+='<td id="kkcrm7_'+n[r][0]+'_0"></td>',a+='<td id="kkcrm8_'+n[r][0]+'_0"></td>',a+='<td id="kkcrm9_'+n[r][0]+'_0"></td>',a+='<td id="kkcrm10_'+n[r][0]+'_0"></td>',a+="<td></td>",a+='<td><button type="button" id="refresh_'+n[r][0]+'" class="btn btn-link btn-sm btn_kkrefresh"><span class="glyphicon glyphicon-refresh" aria-hidden="true"></span></button></td>',a+="</tr>"}else{var i=0;position_ids=m.split(",");for(var r=0;r<position_ids.length;r++){var s=position_ids[r].substring(0,2),l=position_ids[r].substring(2);if("ll"==s){for(var o=0;o<d.length;o++)if(l==d[o][0]){a+='<tr id="row_'+l+'" class="crm_row" style="border-top: 1px solid #00b9ab !important"><td>'+ ++i+"</td>",a+='<td><span id="ll'+l+'" class="payment_badge payment_badge_blue crm_name_row">'+d[o][1]+"</span></td>",a+='<td id="crm0_'+l+'_0">-</td>',a+='<td id="crm1_'+l+'_0"></td>',a+='<td id="crm2_'+l+'_0"></td>',a+='<td id="crm3_'+l+'_0"></td>',a+='<td id="crm4_'+l+'_0"></td>',a+='<td id="crm5_'+l+'_0"></td>',a+='<td id="crm6_'+l+'_0"></td>',a+='<td id="crm7_'+l+'_0"></td>',a+='<td id="crm8_'+l+'_0"></td>',a+='<td id="crm9_'+l+'_0"></td>',a+='<td id="crm10_'+l+'_0"></td>',a+='<td><button type="button" id="setting_'+l+'" class="btn btn-link btn-sm btn_setting" data-toggle="modal" data-target="#setting_edit_modal"><span class="glyphicon glyphicon-list" aria-hidden="true"></span></button></td>',a+='<td><button type="button" id="refresh_'+l+'" class="btn btn-link btn-sm btn_refresh"><span class="glyphicon glyphicon-refresh" aria-hidden="true"></span></button></td>',a+="</tr>";break}}else if(null!=n)for(var o=0;o<n.length;o++)if(l==n[o][0]){a+='<tr id="kkrow_'+l+'" class="kkcrm_row" style="border-top: 1px solid #00b9ab !important"><td>'+ ++i+"</td>",a+='<td><span id="kk'+l+'" class="payment_badge payment_badge_red crm_name_row">'+n[o][1]+"</span></td>",a+='<td id="kkcrm0_'+l+'_0">-</td>',a+='<td id="kkcrm1_'+l+'_0"></td>',a+='<td id="kkcrm2_'+l+'_0"></td>',a+='<td id="kkcrm3_'+l+'_0"></td>',a+='<td id="kkcrm4_'+l+'_0"></td>',a+='<td id="kkcrm5_'+l+'_0"></td>',a+='<td id="kkcrm6_'+l+'_0"></td>',a+='<td id="kkcrm7_'+l+'_0"></td>',a+='<td id="kkcrm8_'+l+'_0"></td>',a+='<td id="kkcrm9_'+l+'_0"></td>',a+='<td id="kkcrm10_'+l+'_0"></td>',a+="<td></td>",a+='<td><button type="button" id="refresh_'+l+'" class="btn btn-link btn-sm btn_kkrefresh"><span class="glyphicon glyphicon-refresh" aria-hidden="true"></span></button></td>',a+="</tr>";break}}for(var r=0;r<d.length;r++){for(var _=!1,o=0;o<position_ids.length;o++){var s=position_ids[o].substring(0,2),l=position_ids[o].substring(2);if("ll"==s&&l==d[r][0]){_=!0;break}}_||(a+='<tr id="row_'+d[r][0]+'" class="crm_row" style="border-top: 1px solid #00b9ab !important"><td>'+(r+1)+"</td>",a+='<td><span id="ll'+d[r][0]+'" class="payment_badge payment_badge_blue crm_name_row">'+d[r][1]+"</span></td>",a+='<td id="crm0_'+d[r][0]+'_0">-</td>',a+='<td id="crm1_'+d[r][0]+'_0"></td>',a+='<td id="crm2_'+d[r][0]+'_0"></td>',a+='<td id="crm3_'+d[r][0]+'_0"></td>',a+='<td id="crm4_'+d[r][0]+'_0"></td>',a+='<td id="crm5_'+d[r][0]+'_0"></td>',a+='<td id="crm6_'+d[r][0]+'_0"></td>',a+='<td id="crm7_'+d[r][0]+'_0"></td>',a+='<td id="crm8_'+d[r][0]+'_0"></td>',a+='<td id="crm9_'+d[r][0]+'_0"></td>',a+='<td id="crm10_'+d[r][0]+'_0"></td>',a+='<td><button type="button" id="setting_'+d[r][0]+'" class="btn btn-link btn-sm btn_setting" data-toggle="modal" data-target="#setting_edit_modal"><span class="glyphicon glyphicon-list" aria-hidden="true"></span></button></td>',a+='<td><button type="button" id="refresh_'+d[r][0]+'" class="btn btn-link btn-sm btn_refresh"><span class="glyphicon glyphicon-refresh" aria-hidden="true"></span></button></td>',a+="</tr>")}if(null!=n)for(var r=0;r<n.length;r++){for(var _=!1,o=0;o<position_ids.length;o++){var s=position_ids[o].substring(0,2),l=position_ids[o].substring(2);if("kk"==s&&l==n[r][0]){_=!0;break}}_||(a+='<tr id="kkrow_'+n[r][0]+'" class="kkcrm_row" style="border-top: 1px solid #00b9ab !important"><td>'+(d.length+r+1)+"</td>",a+='<td><span id="kk'+n[r][0]+'" class="payment_badge payment_badge_red crm_name_row">'+n[r][1]+"</span></td>",a+='<td id="kkcrm0_'+n[r][0]+'_0">-</td>',a+='<td id="kkcrm1_'+n[r][0]+'_0"></td>',a+='<td id="kkcrm2_'+n[r][0]+'_0"></td>',a+='<td id="kkcrm3_'+n[r][0]+'_0"></td>',a+='<td id="kkcrm4_'+n[r][0]+'_0"></td>',a+='<td id="kkcrm5_'+n[r][0]+'_0"></td>',a+='<td id="kkcrm6_'+n[r][0]+'_0"></td>',a+='<td id="kkcrm7_'+n[r][0]+'_0"></td>',a+='<td id="kkcrm8_'+n[r][0]+'_0"></td>',a+='<td id="kkcrm9_'+n[r][0]+'_0"></td>',a+='<td id="kkcrm10_'+n[r][0]+'_0"></td>',a+="<td></td>",a+='<td><button type="button" id="refresh_'+n[r][0]+'" class="btn btn-link btn-sm btn_kkrefresh"><span class="glyphicon glyphicon-refresh" aria-hidden="true"></span></button></td>',a+="</tr>")}}t(".table_dashboard_sales_body").html(a),u();for(var r=0;r<d.length;r++)f(d[r][0],d[r][7]);if(null!=n)for(var r=0;r<n.length;r++)g(n[r][0],n[r][7])},failure:function(t){p("sales","",!1),h("sales","Cannot load Konnective CRM account information.")}})):window.location.href="../../admin/login.php":h("sales","Cannot load CRM site information.")},failure:function(t){p("sales","",!1),h("sales","Cannot load CRM site information.")}})}function f(e,a){""!=t("#from_date").val()?""!=t("#to_date").val()?(p("crm",e,!0),t.ajax({type:"GET",url:"../daemon/ajax_admin/dashboard_sales.php",data:{crm_id:e,crm_goal:a,from_date:t("#from_date").val(),to_date:t("#to_date").val()},success:function(e){var a=jQuery.parseJSON(e);if("error"==a[0])return h("sales","Cannot load sales information."),void t("#crm1_"+a[1]+"_0").html(r);if("no_cookie"!=a[0])for(var d=0;d<a[3].length;d++){var i=a[3][d][0],n=a[3][d][1],s=a[3][d][2];if("0"!=i){var l="";l+='<tr class="subrow_'+a[1]+'">',l+='<td style="border-top:none"></td>',l+='<td style="border-top:none"></td>',l+='<td id="crm0_'+a[1]+"_"+i+'">'+n+"</td>",l+='<td id="crm1_'+a[1]+"_"+i+'"></td>',l+='<td id="crm2_'+a[1]+"_"+i+'"></td>',l+='<td id="crm3_'+a[1]+"_"+i+'"></td>',l+='<td id="crm4_'+a[1]+"_"+i+'"></td>',l+='<td id="crm5_'+a[1]+"_"+i+'"></td>',l+='<td id="crm6_'+a[1]+"_"+i+'"></td>',l+='<td id="crm7_'+a[1]+"_"+i+'"></td>',l+='<td id="crm8_'+a[1]+"_"+i+'"></td>',l+='<td id="crm9_'+a[1]+"_"+i+'"></td>',l+='<td id="crm10_'+a[1]+"_"+i+'"></td>',l+="<td></td>",l+="<td></td>",l+="</tr>",t("#row_"+a[1]).closest("tr").after(l)}var o=parseFloat(a[3][d][3]),_=parseFloat(a[3][d][4]),c=parseFloat(a[3][d][5]),m=parseFloat(a[3][d][6]),p=(parseFloat(a[3][d][7]),parseFloat(a[3][d][8])),b=parseFloat(a[3][d][9]),f=parseFloat(a[3][d][10]),g=parseFloat(a[3][d][11]),v=parseFloat(a[3][d][12]),y=parseFloat(a[2]);if("0"==i){var w='<div class="bar-main-container"><div id="bar_'+a[1]+'" class="bar-percentage">0</div><div class="bar-container"><div class="bar"></div></div></div>';t("#crm9_"+a[1]+"_"+i).html(w)}else y=s;if(t("#crm1_"+a[1]+"_"+i).html(o),t("#crm2_"+a[1]+"_"+i).html(_),0!=o){var x=100*_/o;t("#crm3_"+a[1]+"_"+i).html(x.toFixed(2))}else t("#crm3_"+a[1]+"_"+i).html("0");if(t("#crm4_"+a[1]+"_"+i).html(c),c+p!=0){var F=100*c/(c+p);t("#crm5_"+a[1]+"_"+i).html(F.toFixed(2))}else t("#crm5_"+a[1]+"_"+i).html("0");if(t("#crm6_"+a[1]+"_"+i).html(m),0!=f){var j=b/f;t("#crm7_"+a[1]+"_"+i).html(j.toFixed(2))}else t("#crm7_"+a[1]+"_"+i).html("0");if(0!=v){var D=g/v;t("#crm8_"+a[1]+"_"+i).html(D.toFixed(2))}else t("#crm8_"+a[1]+"_"+i).html("0");t("#crm10_"+a[1]+"_"+i).html(o+" / "+y);var M=0;if(y>0&&(M=Math.round(100*o/y)),"0"==i){var C=t("#bar_"+a[1]);t({countNum:M}).animate({countNum:M},{duration:2e3,easing:"linear",step:function(){var t=this.countNum+"%";C.text(t)&&C.siblings().children().css("width",t)}}),k()}else t("#crm9_"+a[1]+"_"+i).html(M+"%");u()}else window.location.href="../../admin/login.php"},failure:function(t){h("sales","Cannot load sales information.")}})):h("sales","Please select TO DATE."):h("sales","Please select FROM DATE.")}function g(e,a){""!=t("#from_date").val()?""!=t("#to_date").val()?(p("kkcrm",e,!0),t.ajax({type:"GET",url:"../daemon/ajax_admin/konnektive/dashboard_sales.php",data:{crm_id:e,crm_goal:a,from_date:t("#from_date").val(),to_date:t("#to_date").val()},success:function(e){var a=jQuery.parseJSON(e);if("error"==a[0])return h("sales","Cannot load konnektive sales information."),void t("#kkcrm1_"+a[1]+"_0").html(r);if("no_cookie"!=a[0]){var d=parseFloat(a[3][0]),i=parseFloat(a[2]),n='<div class="bar-main-container"><div id="kkbar_'+a[1]+'" class="bar-percentage">0</div><div class="bar-container"><div class="bar"></div></div></div>';t("#kkcrm9_"+a[1]+"_0").html(n),t("#kkcrm1_"+a[1]+"_0").html(a[3][0]),t("#kkcrm2_"+a[1]+"_0").html(a[3][1]),t("#kkcrm3_"+a[1]+"_0").html(a[3][2]),t("#kkcrm4_"+a[1]+"_0").html(a[3][3]),t("#kkcrm5_"+a[1]+"_0").html(a[3][4]),t("#kkcrm6_"+a[1]+"_0").html(a[3][5]),t("#kkcrm7_"+a[1]+"_0").html(a[3][6]),t("#kkcrm8_"+a[1]+"_0").html(a[3][7]),t("#kkcrm10_"+a[1]+"_0").html(d+" / "+i);var s=0;i>0&&(s=Math.round(100*d/i));var l=t("#kkbar_"+a[1]);t({countNum:0}).animate({countNum:s},{duration:2e3,easing:"linear",step:function(){var t=Math.round(this.countNum)+"%";l.text(t)&&l.siblings().children().css("width",t)}})}else window.location.href="../../admin/login.php"},failure:function(t){h("sales","Cannot load konnektive sales information.")}})):h("sales","Please select TO DATE."):h("sales","Please select FROM DATE.")}function k(){var e=0,a=0,r=0,d=0,i=0,n=0,s=0,l=0,o=0,_=0,c=0;t(".crm_row").each(function(d){var c=t(this).prop("id").substring(4);if(!isNaN(t("#crm1_"+c+"_0").html())){a+=parseInt(t("#crm1_"+c+"_0").html()),r+=parseInt(t("#crm2_"+c+"_0").html()),i+=parseInt(t("#crm4_"+c+"_0").html()),n+=parseFloat(t("#crm5_"+c+"_0").html()),s+=parseInt(t("#crm6_"+c+"_0").html()),l+=parseFloat(t("#crm7_"+c+"_0").html()),o+=parseFloat(t("#crm8_"+c+"_0").html());var m=t("#crm10_"+c+"_0").html(),h=m.indexOf(" / ");_+=parseInt(m.substr(h+3)),e++}}),_>0&&(c=(100*a/_).toFixed(2)),a>0&&(d=(100*r/a).toFixed(2)),e>0&&(t("#all1").html(a),t("#all2").html(r),t("#all3").html(d),t("#all4").html(i),t("#all5").html((n/e).toFixed(2)),t("#all6").html(s),t("#all7").html((l/e).toFixed(2)),t("#all8").html((o/e).toFixed(2)),t("#all9").html(c),t("#all10").html(a+" / "+_))}function v(){t("#from_date").prop("disabled",!0),t("#to_date").prop("disabled",!0);var e=new Date,a=y(e.getFullYear(),e.getMonth()+1,e.getDate());if("date_today"==l)o=a,_=a;else if("date_yesterday"==l)e.setDate(e.getDate()-1),o=y(e.getFullYear(),e.getMonth()+1,e.getDate()),_=y(e.getFullYear(),e.getMonth()+1,e.getDate());else if("date_thisweek"==l){var r=e.getDate()+1;0==e.getDay()?r-=7:r-=e.getDay(),e.setDate(r),o=y(e.getFullYear(),e.getMonth()+1,e.getDate()),_=a}else if("date_thismonth"==l)o=y(e.getFullYear(),e.getMonth()+1,1),_=a;else if("date_thisyear"==l)o=y(e.getFullYear(),1,1),_=a;else if("date_lastweek"==l){r=e.getDate()+1-7;0==e.getDay()?r-=7:r-=e.getDay(),e.setDate(r),o=y(e.getFullYear(),e.getMonth()+1,e.getDate()),r=e.getDate()+6,e.setDate(r),_=y(e.getFullYear(),e.getMonth()+1,e.getDate())}else"date_custom"==l&&(o="",_="",t("#from_date").prop("disabled",!1),t("#to_date").prop("disabled",!1));t("#from_date").val(o),t("#to_date").val(_)}function y(t,e,a){var r=a,d=e;return r<10&&(r="0"+r),d<10&&(d="0"+d),d+"/"+r+"/"+t}m=t("#crm_positions").html(),v(),p("sales","",!0),t.ajax({type:"GET",url:"../daemon/ajax_admin/dashboard_columns_get.php",data:{},success:function(t){p("sales","",!1);var e=jQuery.parseJSON(t);if("success"==e[0])c=e[1];else if("no_cookie"==e[0])return void(window.location.href="../../admin/login.php");b()},failure:function(t){p("sales","",!1),h("sales","Cannot load columns for dashboard.")}}),t(".input-daterange").datepicker({}),t(".date_dropdown_menu li").on("click",function(e){var a=t(this).text();l=t(this).find("a").attr("id"),t(".date_toggle_button").html(a+' <span class="caret"></span>'),v()}),t(".sales_search_button").click(function(){b()}),t(".btn_crm_position").click(function(){var e="",a="",r=0;t(".crm_name_row").each(function(d){var i=t(this).prop("id"),n=t(this).html();a+='<li style="margin-bottom: 10px"><span class="payment_badge payment_badge_grey">'+ ++r+"</span></li>","ll"==i.substring(0,2)?e+='<li id="'+i+'" class="position_row" style="cursor: move; margin-bottom: 10px"><span class="payment_badge payment_badge_blue">'+n+"</span></li>":e+='<li id="'+i+'" class="position_row" style="cursor: move; margin-bottom: 10px"><span class="payment_badge payment_badge_red">'+n+"</span></li>"}),t("#crm_number_ul").html(a),t("#crm_number_ul").disableSelection(),t("#crm_position_ul").html(e),t("#crm_position_ul").sortable(),t("#crm_position_ul").disableSelection(),t("#crm_position_modal").modal("toggle")}),t(".modal_btn_crm_position").click(function(){var e,a="";t(".position_row").each(function(e){var r=t(this).prop("id");a+=""==a?"":",",a+=r}),e=a,p("sales","",!0),t.ajax({type:"GET",url:"../daemon/ajax_admin/crm_position_set.php",data:{crm_positions:e},success:function(a){if(p("sales","",!1),"success"==a)m=e,t("#crm_positions").html(m),b();else{if("no_cookie"==a)return void(window.location.href="../../admin/login.php");h("sales","Cannot save CRM positions.")}},failure:function(t){p("sales","",!1),h("sales","Cannot save CRM positions.")}}),t("#crm_position_modal").modal("toggle")}),t(".btn_refresh_all").click(function(){b()}),t(".table_dashboard_sales_body").on("click",".btn_refresh",function(e){i=t(this).prop("id").substring(8);for(var a=0;a<d.length;a++)if(d[a][0]==i)return void f(i,d[a][7])}),t(".table_dashboard_sales_body").on("click",".btn_kkrefresh",function(e){s=t(this).prop("id").substring(8);for(var a=0;a<n.length;a++)if(n[a][0]==s)return void g(s,n[a][7])}),t(".table_dashboard_sales_body").on("click",".btn_setting",function(a){var r;i=t(this).prop("id").substring(8),r=i,t.ajax({type:"GET",url:"../daemon/ajax_admin/setting_alert_list_by_cid.php",data:{crm_id:r},success:function(a){var r=jQuery.parseJSON(a);if("error"!=r[0])if("no_cookie"!=r[0]){var d=(e=r[2]).length,i="";i+='<div class="row" style="margin-bottom:5px;">',i+='<div class="col-xs-6 modal_input_label"><label>Alert Level Management</label></div>',i+="</div>";for(var n=0;n<d;n++)"1"==e[n][8]&&(i+='<div class="row" style="margin-bottom:5px;">',i+='<div class="col-xs-6 modal_input_label">'+e[n][3]+"</div>",i+='<div class="col-xs-6"><input type="text" class="form-control input-sm edit_level_'+e[n][2]+'" value="'+e[n][4]+'"></div>',i+="</div>");t(".modal_setting_alert_body").html(i)}else window.location.href="../../admin/login.php";else h("setting","Cannot load alert level information.")},failure:function(t){h("setting","Cannot load alert level information.")}});for(var n=0;n<d.length;n++)if(d[n][0]==i)return t(".edit_crm_name").val(d[n][1]),t(".edit_crm_url").val(d[n][2]),t(".edit_crm_username").val(d[n][3]),t(".edit_api_username").val(d[n][5]),t(".edit_sales_goal").val(d[n][7]),void("1"==d[n][8]?t(".edit_crm_paused").prop("checked",!0):t(".edit_crm_paused").prop("checked",!1))}),t(".modal_btn_setting_edit").click(function(){if(""==t(".edit_crm_name").val())return h("setting","Please input CRM Name."),void t(".edit_crm_name").focus();if(""==t(".edit_crm_url").val())return h("setting","Please input CRM Site URL."),void t(".edit_crm_url").focus();if(""==t(".edit_crm_username").val())return h("setting","Please input CRM User Name."),void t(".edit_crm_username").focus();if(""==t(".edit_api_username").val())return h("setting","Please input API User Name."),void t(".edit_api_username").focus();if(""==t(".edit_sales_goal").val())return h("setting","Please input Sales Goal."),void t(".edit_sales_goal").focus();for(var a=0;a<e.length;a++)if("1"==e[a][8]&&""==t(".edit_level_"+e[a][2]).val())return h("setting","Please input Alert level."),void t(".edit_level_"+e[a][2]).focus();t("#setting_edit_modal").modal("toggle"),function(){var e=0;t(".edit_crm_paused").prop("checked")&&(e=1);t.ajax({type:"GET",url:"../daemon/ajax_admin/setting_crm_edit.php",data:{crm_id:i,crm_name:t(".edit_crm_name").val(),crm_url:t(".edit_crm_url").val(),crm_username:t(".edit_crm_username").val(),api_username:t(".edit_api_username").val(),sales_goal:t(".edit_sales_goal").val(),crm_paused:e},success:function(t){if("success"==t)b();else{if("no_cookie"==t)return void(window.location.href="../../admin/login.php");h("sales","CRM information cannot be changed.")}},failure:function(t){p(!1),h("sales","CRM information cannot be changed.")}})}();for(a=0;a<e.length;a++)"1"==e[a][8]&&(r=e[a][2],d=i,n=t(".edit_level_"+e[a][2]).val(),s="0",t.ajax({type:"GET",url:"../daemon/ajax_admin/setting_alert_edit.php",data:{type:r,crm_id:d,level1:n,level2:s},success:function(t){if("error"==t)h("sales","Alert level cannot be changed.");else if("no_cookie"==t)return void(window.location.href="../../admin/login.php")},failure:function(t){h("sales","Alert level cannot be changed.")}}));var r,d,n,s}),t(".dashboard_alert_body").on("click",".btn_alert",function(e){var a=t(this).prop("id").substring(6);-1!=t(this).html().indexOf("glyphicon-triangle-bottom")?(t(this).html('<span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span>'),t("#abody_"+a).slideUp("1000",function(){t("#atitle_"+a).css("border-bottom","1px solid #ebccd1"),t("#atitle_"+a).css("background","#f9f2f4"),t("#abody_"+a).css("background","#f9f2f4"),t("#acontent_"+a).css("background","#f9f2f4")})):(t(this).html('<span class="glyphicon glyphicon-triangle-bottom" aria-hidden="true" style="color: #ffa5a5"></span>'),t("#abody_"+a).slideDown("1000"),t("#atitle_"+a).css("border-bottom","none"),t("#atitle_"+a).css("background","#fff"),t("#abody_"+a).css("background","#fff"),t("#acontent_"+a).css("background","#fff"))})});