jQuery(document).ready(function(t){function e(){t(".crm_dropdown_list").length>0&&(m=t(".crm_dropdown_list").prop("id"))}function a(e){t(".order_report_alert").html(e),t(".order_report_alert").fadeIn(1e3,function(){t(".order_report_alert").fadeOut(3e3)})}function o(e){t(".order_report_waiting").html(e?g:"")}function r(){""!=t("#from_date").val()?""!=t("#to_date").val()?(o(!0),t.ajax({type:"POST",url:"../daemon/ajax_admin/konnektive/order_summary_report.php",data:{crm_id:m,from_date:t("#from_date").val(),to_date:t("#to_date").val(),campaign_ids:_(w),campaign_names:f(w),product_id:k,affiliate_id:x},success:function(e){o(!1);var r=jQuery.parseJSON(e);if(t(".table_order_report_body").html(""),"success"!=r[0])return"no_cookie"==r[0]?void(window.location.href="../../admin/login.php"):void 0;var i="",n="---",d=r[2];if("error"!=d&&"No results found."!=d){for(var l=0;l<d.length;l++)i+="<tr>",i+="<td>"+d[l][0]+"</td>",i+="<td>"+d[l][1]+"</td>",i+="<td>"+d[l][2]+(d[l][2]!=n?"%":"")+"</td>",i+="<td>"+d[l][3]+"</td>",i+="<td>"+d[l][4]+(d[l][4]!=n?"%":"")+"</td>",i+="<td>"+d[l][5]+"</td>",i+="<td>"+d[l][6]+(d[l][6]!=n?"%":"")+"</td>",i+="<td>"+(d[l][7]!=n?"$":"")+d[l][7]+"</td>",i+="<td>"+d[l][8]+"</td>",i+="<td>"+(d[l][9]!=n?"$":"")+d[l][9]+"</td>",i+="<td>"+(d[l][10]!=n?"$":"")+d[l][10]+"</td>",i+="<td>"+(d[l][11]!=n?"$":"")+d[l][11]+"</td>",i+="<td>"+d[l][12]+"</td>",i+="<td>"+(d[l][13]!=n?"$":"")+d[l][13]+"</td>",i+="<td>"+(d[l][14]!=n?"$":"")+d[l][14]+"</td>",i+="</tr>";t(".table_order_report_body").html(i)}else a(d)},failure:function(t){o(!1),a("Cannot load order summary.")}})):a("Please select TO DATE."):a("Please select FROM DATE.")}function i(){w=0,t(".category_toggle_button").html("All Categories"+j),t.ajax({type:"GET",url:"../daemon/ajax_admin/konnektive/campaign_category_list.php",data:{crm_id:m},success:function(e){var a='<li><a href="#" id="0">All Campaigns</a></li>';if("error"==e)return w=0,void t(".category_dropdown_menu").html(a);if("no_cookie"!=e){u=jQuery.parseJSON(e);for(var o=0;o<u.length;o++)a+='<li><a href="#" id="'+u[o][0]+'">'+u[o][1]+"</a></li>";t(".category_dropdown_menu").html(a)}else window.location.href="../../admin/login.php"},failure:function(t){a("main","Cannot load campaign category list.")}})}function n(){k=0,x=0,t(".product_toggle_button").html("All Products"+j),t(".affiliate_toggle_button").html("All Affiliates"+j),t(".product_dropdown_menu").html('<li><a href="#" id="0">All Products</a></li>'),t(".affiliate_dropdown_menu").html('<li><a href="#" id="0">All Affiliates</a></li>'),t.ajax({type:"GET",url:"../daemon/ajax_admin/konnektive/product_affiliate_list.php",data:{crm_id:m},success:function(e){var a=jQuery.parseJSON(e);if("no_cookie"!=a[0]){if("success"==a[0]){var o='<li><a href="#" id="0">All Products</a></li>';c=a[2];for(r=0;r<c.length;r++)o+='<li><a href="#" id="'+c[r][0]+'">'+c[r][1]+"</a></li>";t(".product_dropdown_menu").html(o),o='<li><a href="#" id="0">All Affiliates</a></li>',s=a[3];for(var r=0;r<s.length;r++)o+='<li><a href="#" id="'+s[r][0]+'">'+s[r][1]+"</a></li>";t(".affiliate_dropdown_menu").html(o)}}else window.location.href="../../admin/login.php"},failure:function(t){a("main","Cannot load product & affiliate list.")}})}function d(){t("#from_date").prop("disabled",!0),t("#to_date").prop("disabled",!0);var e=new Date,a=l(e.getFullYear(),e.getMonth()+1,e.getDate());if("date_today"==p)y=a,v=a;else if("date_yesterday"==p)e.setDate(e.getDate()-1),y=l(e.getFullYear(),e.getMonth()+1,e.getDate()),v=l(e.getFullYear(),e.getMonth()+1,e.getDate());else if("date_thisweek"==p){o=e.getDate()+1;0==e.getDay()?o-=7:o-=e.getDay(),e.setDate(o),y=l(e.getFullYear(),e.getMonth()+1,e.getDate()),v=a}else if("date_thismonth"==p)y=l(e.getFullYear(),e.getMonth()+1,1),v=a;else if("date_thisyear"==p)y=l(e.getFullYear(),1,1),v=a;else if("date_lastweek"==p){var o=e.getDate()+1-7;0==e.getDay()?o-=7:o-=e.getDay(),e.setDate(o),y=l(e.getFullYear(),e.getMonth()+1,e.getDate()),o=e.getDate()+6,e.setDate(o),v=l(e.getFullYear(),e.getMonth()+1,e.getDate())}else"date_custom"==p&&(y="",v="",t("#from_date").prop("disabled",!1),t("#to_date").prop("disabled",!1));t("#from_date").val(y),t("#to_date").val(v)}function l(t,e,a){var o=a,r=e,i=t;return o<10&&(o="0"+o),r<10&&(r="0"+r),r+"/"+o+"/"+i}function _(t){try{for(var e=0;e<u.length;e++)if(t==u[e][0])return u[e][2]}catch(t){return""}return""}function f(t){try{for(var e=0;e<u.length;e++)if(t==u[e][0])return u[e][3]}catch(t){return""}return""}var u,c,s,g='<img src="../images/loading.gif" style="width:22px;height:22px;">',h="",m=-1,p="date_thisweek",y="",v="",w=0,D="",k=0,b="",x=0,A="",j=' <span class="caret"></span>';d(),e(),i(),n(),r(),t(".crm_dropdown_menu").on("click","li",function(e){h=t(this).text(),m=t(this).find("a").attr("id"),t(".crm_toggle_button").html(h+j),i(),n()}),t(".input-daterange").datepicker({}),t(".date_dropdown_menu").on("click","li",function(e){var a=t(this).text();p=t(this).find("a").attr("id"),t(".date_toggle_button").html(a+j),d()}),t(".category_dropdown_menu").on("click","li",function(e){D=t(this).text(),w=t(this).find("a").attr("id"),t(".category_toggle_button").html(D+j)}),t(".product_dropdown_menu").on("click","li",function(e){b=t(this).text(),k=t(this).find("a").attr("id"),t(".product_toggle_button").html(b+j)}),t(".affiliate_dropdown_menu").on("click","li",function(e){A=t(this).text(),x=t(this).find("a").attr("id"),t(".affiliate_toggle_button").html(A+j)}),t(".orders_search_button").click(function(){r()})});