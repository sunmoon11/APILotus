jQuery(document).ready(function(a){var e,i='<img src="../images/loading.gif" style="width:22px;height:22px;">';function o(e,o){"profile"==e?o?a(".ap_profile_waiting").html(i):a(".ap_profile_waiting").html(""):"history"==e&&(o?a(".ap_login_history_waiting").html(i):a(".ap_login_history_waiting").html(""))}function l(e,i){"profile"==e?(a(".ap_profile_alert").html(i),a(".ap_profile_alert").fadeIn(1e3,function(){a(".ap_profile_alert").fadeOut(3e3)})):"history"==e?(a(".ap_login_history_alert").html(i),a(".ap_login_history_alert").fadeIn(1e3,function(){a(".ap_login_history_alert").fadeOut(3e3)})):"password"==e?(a(".change_password_alert").html(i),a(".change_password_alert").fadeIn(1e3,function(){a(".change_password_alert").fadeOut(3e3)})):"update"==e&&(a(".edit_profile_alert").html(i),a(".edit_profile_alert").fadeIn(1e3,function(){a(".edit_profile_alert").fadeOut(3e3)}))}function r(){o("profile",!0),a.ajax({type:"GET",url:"../daemon/ajax_adminpanel/profile_list.php",data:{},success:function(i){if(o("profile",!1),"error"!=i)if("no_cookie"!=i){var r=jQuery.parseJSON(i);e=r[1],a(".profile_user_id").val(e[0][1]),a(".profile_display_name").val(e[0][3]),a(".profile_email_address").val(e[0][4])}else window.location.href="../adminpanel/login.php";else l("profile","Cannot load profile list.")},failure:function(a){o("profile",!1),l("profile","Cannot load profile list.")}})}r(),o("history",!0),a.ajax({type:"GET",url:"../daemon/ajax_adminpanel/login_history_list.php",data:{},success:function(e){if(o("history",!1),"error"!=e)if("no_cookie"!=e){for(var i=jQuery.parseJSON(e),r=i[1],n="",t=0;t<r.length;t++)n+="<tr>",n+="<td>"+r[t][6]+"</td>",n+="<td>"+r[t][5]+"</td>",n+="<td>"+r[t][2]+"</td>",n+='<td style="word-break:break-all">'+r[t][3]+"</td>",n+="<td>"+r[t][1]+"</td>",n+="<td>"+r[t][4]+"</td>",n+="</tr>";a(".table_login_history_body").html(n),a(".login_history_result").html("around "+r.length+" results")}else window.location.href="../adminpanel/login.php";else l("history","Cannot load login history.")},failure:function(a){o("history",!1),l("history","Cannot load login history.")}}),a(".btn_change_password").click(function(){a(".input_password").val(""),a(".input_repassword").val(""),a("#change_password_modal").modal("toggle")}),a(".modal_btn_change_password").click(function(){return""==a(".input_password").val()?(l("password","Please input New Password."),void a(".input_password").focus()):a(".input_password").val()!=a(".input_repassword").val()?(l("password","Doesn't match password."),void a(".input_repassword").focus()):(a("#change_password_modal").modal("toggle"),o("profile",!0),void a.ajax({type:"GET",url:"../daemon/ajax_adminpanel/profile_password_update.php",data:{user_id:a(".profile_user_id").val(),password:a(".input_password").val()},success:function(a){o("profile",!1),"no_cookie"!=a?"error"==a&&l("profile","Password cannot be changed."):window.location.href="../adminpanel/login.php"},failure:function(a){o("profile",!1),l("profile","Password cannot be changed.")}}))}),a(".btn_edit_profile").click(function(){a(".input_user_id").val(a(".profile_user_id").val()),a(".input_display_name").val(a(".profile_display_name").val()),a(".input_email_address").val(a(".profile_email_address").val()),a("#edit_profile_modal").modal("toggle")}),a(".modal_btn_edit_profile").click(function(){return""==a(".input_display_name").val()?(l("update","Please input User Name."),void a(".input_display_name").focus()):""==a(".input_email_address").val()?(l("update","Please input Email Address."),void a(".input_email_address").focus()):(a("#edit_profile_modal").modal("toggle"),o("profile",!0),void a.ajax({type:"GET",url:"../daemon/ajax_adminpanel/profile_update.php",data:{user_id:a(".profile_user_id").val(),display_name:a(".input_display_name").val(),email_address:a(".input_email_address").val()},success:function(a){o("profile",!1),"success"!=a?"no_cookie"!=a?"error"==a&&l("profile","Profile cannot be changed."):window.location.href="../adminpanel/login.php":r()},failure:function(a){o("profile",!1),l("profile","Profile cannot be changed.")}}))})});